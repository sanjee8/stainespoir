<!doctype html>
<html lang="fr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Stains Espoir â€” {% block title %}Accueil{% endblock %}</title>
    <meta name="description" content="STAINS ESPOIR â€” Association Ã  but non lucratif : Ã©ducation, culture, citoyennetÃ© et solidaritÃ© Ã  Stains. Votre rÃ©ussite, câ€™est notre devoir.">
    <meta name="csrf-token" content="{{ csrf_token('account_api') }}">
    {% block stylesheets %}
    {% endblock %}

    {% block javascripts %}
        {% block importmap %}{{ importmap('app') }}{% endblock %}
    {% endblock %}

    <link rel="icon" type="image/svg+xml" href="#favicon" />
    <meta name="color-scheme" content="light">
    <script>
        document.documentElement.classList.remove('no-js');
        document.documentElement.classList.add('js');
    </script>
</head>
<body class="home" data-turbo="false">
<a class="skip-link" href="#contenu">Aller au contenu</a>

<!-- Barre haute (contact + rÃ©seaux) -->
<div class="topbar">
    <div class="container topbar-row">
        <div class="topbar-left">
            <span class="small">
                ðŸ“ž {{ setting('site.phone')|u.replaceMatches('/\D+/', '')|u.replaceMatches('/(\d{2})(?=\d)/', '$1 ')|trim }}
            </span>
            <span class="sep" aria-hidden="true">â€¢</span>
            <a class="small" href="mailto:{{ setting('site.email') }}">{{ setting('site.email') }}</a>
        </div>
        <div class="topbar-right">
            <a class="social" target="_blank" href="{{ setting('social.instagram_url') }}" aria-label="Instagram">
                <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5Zm0 2a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V7a3 3 0 0 0-3-3H7Zm5 3.5a5.5 5.5 0 1 1 0 11.001 5.5 5.5 0 0 1 0-11Zm0 2a3.5 3.5 0 1 0 .001 7.001A3.5 3.5 0 0 0 12 9.5ZM18 6.5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"/></svg>
                <span class="small">Instagram</span>
            </a>
            {% if is_granted('ROLE_ADMIN') %}

                <a class="social" href="{{ path('admin') }}" aria-label="Espace admin">
                    <!-- IcÃ´ne admin (cadenas) -->
                    <svg viewBox="0 0 24 24" aria-hidden="true" width="24" height="24">
                        <path d="M17 8h-1V6a4 4 0 10-8 0v2H7a2 2 0 00-2 2v8a2 2 0 002 2h10a2 2 0 002-2v-8a2 2 0 00-2-2Zm-7-2a2 2 0 114 0v2h-4V6Zm2 6a2 2 0 100 4 2 2 0 000-4Z"/>
                    </svg>
                    <span class="small">Espace admin</span>
                </a>
            {% endif %}
        </div>
    </div>
</div>

{% set currentRoute = app.request.attributes.get('_route') %}

<header class="site-header">
    <div class="container header-row">
        <a href="{{ path('app_home') }}" class="brand" aria-label="Accueil Stains Espoir">
            <img src="{{ asset('images/logo-FINAL-1.png') }}" class="brand-logo" alt="Stains Espoir â€” logo" />
            <span class="brand-name">Stains&nbsp;Espoir</span>
        </a>

        <button class="nav-toggle" id="navToggle" aria-expanded="false" aria-controls="siteNav" aria-label="Menu">
            <span class="sr-only">Menu</span>
            <svg width="28" height="28" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
        </button>

        <nav id="siteNav" class="primary-nav" aria-label="Navigation principale">
            <ul>
                {% for item in main_nav %}
                    {# Actif si route exacte ou si pattern matches #}
                    {% set isActive = (currentRoute == (item.route ?? null)) %}
                    {% if not isActive and item.active_when is defined %}
                        {% for pat in item.active_when %}
                            {% if currentRoute matches '/' ~ pat ~ '/' %}
                                {% set isActive = true %}
                            {% endif %}
                        {% endfor %}
                    {% endif %}

                    <li class="{{ (item.type ?? 'link') == 'dropdown' ? 'has-dropdown' }}">
                        {% if (item.type ?? 'link') == 'dropdown' and item.children is defined and item.children|length %}
                            <button class="dropdown-toggle {{ isActive ? 'active' }}" type="button" aria-haspopup="true" aria-expanded="false">
                                <!-- IcÃ´ne utilisateur -->
                                <svg viewBox="0 0 24 24" aria-hidden="true" width="18" height="18" style="margin-right:6px;">
                                    <path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-5 0-9 2.5-9 5.5A1.5 1.5 0 0 0 4.5 21h15A1.5 1.5 0 0 0 21 19.5C21 16.5 17 14 12 14Z"/>
                                </svg>
                                <span>{{ item.label }}</span>
                                <svg viewBox="0 0 24 24" aria-hidden="true" width="16" height="16" style="margin-left:6px;">
                                    <path d="M7 10l5 5 5-5"/>
                                </svg>
                            </button>

                            <ul class="dropdown-menu" role="menu">
                                {% for child in item.children %}
                                    {% if child.show_when is not defined
                                        or (child.show_when == 'guest' and not app.user)
                                        or (child.show_when == 'auth'  and app.user) %}
                                        <li role="none">
                                            {% if child.is_logout ?? false %}
                                                <form role="menuitem" method="post" action="{{ path(child.route) }}">
                                                    <input type="hidden" name="_csrf_token" value="{{ csrf_token('logout') }}">
                                                    <button type="submit" class="linklike">Se dÃ©connecter</button>
                                                </form>
                                            {% else %}
                                                <a role="menuitem" href="{{ path(child.route) }}">{{ child.label }}</a>
                                            {% endif %}
                                        </li>
                                    {% endif %}
                                {% endfor %}
                            </ul>
                        {% else %}
                            <a href="{{ item.route is defined ? path(item.route) : '#' }}"
                               class="{{ isActive ? 'active' }}"
                               {% if isActive %}aria-current="page"{% endif %}>
                                {{ item.label }}
                            </a>
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        </nav>


        <div class="nav-backdrop" id="navBackdrop" hidden></div>
    </div>
</header>


{% block body %}{% endblock %}


<footer class="site-footer creative-footer" aria-label="Pied de page">
    <div class="container footer-top">
        <div class="ft-brand">
            <a href="{{ path('app_home') }}" class="brand brand-footer">
                <img src="{{ asset('images/logo_final-300x194.png') }}" class="brand-logo-big" alt="Stains Espoir" />
            </a>
            <p class="small tagline">Votre rÃ©ussite, câ€™est notre devoir.</p>

        </div>

        <nav class="ft-nav" aria-label="Navigation pied de page">
            <h3 class="ft-title">Navigation</h3>
            <ul role="list">
                <li><a href="{{ path('app_asso') }}">Lâ€™association</a></li>
                <li><a href="{{ path('app_register') }}">AdhÃ©rer</a></li>
                <li><a href="{{ path('app_benevole') }}">Devenir bÃ©nÃ©vole</a></li>
            </ul>
        </nav>


        <div class="ft-contact">
            <h3 class="ft-title">Nous contacter</h3>
            <ul class="info-list" role="list">
                <li>
                    <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2a7 7 0 0 0-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 0 0-7-7Zm0 9.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5Z"/></svg>
                    <div>
                        <strong>Adresse</strong>
                        <p>6 Avenue Jules Guesde<br>93240 Stains</p>
                    </div>
                </li>
                <li>
                    <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v.4l-9 5.6-9-5.6V5Zm0 3.2V19a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8.2l-8.4 5.2a3 3 0 0 1-3.2 0L3 8.2Z"/></svg>
                    <div>
                        <strong>Email</strong>
                        <p><a class="text-link" href="mailto:{{ setting('site.email') }}">{{ setting('site.email') }}</a></p>
                    </div>
                </li>
                <li>
                    <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M6.6 10.8a13.8 13.8 0 0 0 6.6 6.6l2.2-2.2a1 1 0 0 1 1-.25c1.1.36 2.3.55 3.6.55a1 1 0 0 1 1 1V20a1 1 0 0 1-1 1C10.8 21 3 13.2 3 3a1 1 0 0 1 1-1h3.5a1 1 0 0 1 1 1c0 1.3.19 2.5.55 3.6a1 1 0 0 1-.25 1l-2.2 2.2Z"/></svg>
                    <div>
                        <strong>TÃ©lÃ©phone</strong>
                        <p><a class="text-link" href="tel:+{{ setting('site.phone')|trim }}">{{ setting('site.phone')|u.replaceMatches('/\D+/', '')|u.replaceMatches('/(\d{2})(?=\d)/', '$1 ')|trim }}</a></p>
                    </div>
                </li>
            </ul>
        </div>
    </div>

    <div class="footer-bottom">

        <div class="container footer-bottom-row">
            <p class="small">Â© <span id="year"></span> Stains Espoir â€” Association loi 1901.</p>
            <div class="ft-legal">
                <a href="/mentions-legales">Mentions lÃ©gales</a>
                <span aria-hidden="true">Â·</span>
                <a href="{{ path('app_home') }}">Contact</a>
            </div>
        </div>
    </div></footer>


<!-- DonnÃ©es structurÃ©es -->
<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "NGO",
        "name": "Stains Espoir",
        "address": "6 Avenue Jules Guesde, 93240 Stains",
        "email": "stains.espoir@gmail.com",
        "areaServed": "Stains, France",
        "url": "https://stains-espoir.fr/"
    }
</script>

<script>

    (function () {
        function clearLoadingStates() {
            document.querySelectorAll('.btn.is-loading, .btn[aria-busy="true"]').forEach(el => {
                el.classList.remove('is-loading');
                el.removeAttribute('aria-busy');
                el.removeAttribute('disabled');
            });
        }

        // Turbo (Symfony UX) ?
        document.addEventListener('turbo:load', clearLoadingStates);
        document.addEventListener('turbo:render', clearLoadingStates);

        // Fallback si pas Turbo
        window.addEventListener('pageshow', clearLoadingStates);

        // Optionnel : au clic, mets l'Ã©tat loading et laisse le navigateur naviguer
        document.addEventListener('click', (e) => {
            const a = e.target.closest('a.btn, button.btn');
            if (!a) return;
            // Applique un "loading" visuel court
            a.classList.add('is-loading');
            a.setAttribute('aria-busy', 'true');
            // Ne pas empÃªcher la navigation !
        });
    })();

    // JS minimal: menu mobile + annÃ©e
    (function () {
        const navToggle = document.getElementById('navToggle');
        const siteNav = document.getElementById('siteNav');
        const backdrop = document.getElementById('navBackdrop');
        const yearEl = document.getElementById('year');
        if (yearEl) yearEl.textContent = new Date().getFullYear();

        function openNav() {
            siteNav.classList.add('open');
            backdrop && (backdrop.hidden = false);
            document.body.classList.add('no-scroll');
            navToggle.setAttribute('aria-expanded', 'true');
        }
        function closeNav() {
            siteNav.classList.remove('open');
            backdrop && (backdrop.hidden = true);
            document.body.classList.remove('no-scroll');
            navToggle.setAttribute('aria-expanded', 'false');
        }

        navToggle && navToggle.addEventListener('click', () => {
            const expanded = navToggle.getAttribute('aria-expanded') === 'true';
            expanded ? closeNav() : openNav();
        });

        siteNav && siteNav.querySelectorAll('a').forEach(a => a.addEventListener('click', closeNav));
        backdrop && backdrop.addEventListener('click', closeNav);

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeNav();
        });
    })();
</script>

<!-- Gradients -->
<svg width="0" height="0" style="position:absolute">
    <defs>
        <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0" stop-color="#6A1B9A"/>
            <stop offset="1" stop-color="#B36AD1"/>
        </linearGradient>
    </defs>
</svg>

<!-- Favicon (optionnel) -->
<svg id="favicon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" style="display:none">
    <defs><linearGradient id="gfav" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="#6A1B9A"/><stop offset="1" stop-color="#B36AD1"/></linearGradient></defs>
    <rect x="2" y="2" width="44" height="44" rx="10" fill="url(#gfav)" />
</svg>
</body>
</html>
